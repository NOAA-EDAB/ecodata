<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SOE Data Structure Guidelines • ecodata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SOE Data Structure Guidelines">
<meta property="og:description" content="ecodata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecodata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ecodata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ecodata_maintenance.html">Ecodata maintenance</a>
    </li>
    <li>
      <a href="../articles/landing_page.html">Landing page</a>
    </li>
    <li>
      <a href="../articles/data_guidelines.html">Data guidelines</a>
    </li>
    <li>
      <a href="../articles/geom_gls.html">Using geom_gls</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SOE Data Structure Guidelines</h1>
                        <h4 data-toc-skip class="author">Kimberly
Bastille</h4>
            
            <h4 data-toc-skip class="date">12/1/2020</h4>
      
      
      <div class="hidden name"><code>data_guidelines.Rmd</code></div>

    </div>

    
    
<p>The NEFSC State of the Ecosystem (SOE) report is a collection of
indicators that track the status and trend of the Northeast US Large
Marine Ecosystem. The report is broken into two separate regional
reports to be delivered to the two Fishery Management Councils that the
Center serves: Mid-Atlantic and New England. The SOE contains a diverse
range of indicators from revenue and commercial fisheries reliance
through biomass of aggregate species groups to primary production and
climate drivers.</p>
<div class="section level3">
<h3 id="data-format">Data Format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h3>
<p>There are two different formats for structuring data: wide format and
long format. Most people are familiar with the wide format that
structures data like this:</p>
<p>Table 1: The wide format for data frames (4 columns, 4 rows)</p>
<table class="table">
<thead><tr class="header">
<th>Year</th>
<th>Var A</th>
<th>Var B</th>
<th>Var C</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2010</td>
<td>3</td>
<td>4</td>
<td>11</td>
</tr>
<tr class="even">
<td>2011</td>
<td>5</td>
<td>6</td>
<td>12</td>
</tr>
<tr class="odd">
<td>2012</td>
<td>7</td>
<td>8</td>
<td>13</td>
</tr>
</tbody>
</table>
<p>While this is convenient for reading and human interpretation, many
analyses and graphing routines prefer the long format:</p>
<p>Table 2: The long format for data frames (3 columns, 10 rows)</p>
<table class="table">
<thead><tr class="header">
<th>Year</th>
<th>Var</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2010</td>
<td>A</td>
<td>3</td>
</tr>
<tr class="even">
<td>201o</td>
<td>B</td>
<td>4</td>
</tr>
<tr class="odd">
<td>2010</td>
<td>C</td>
<td>11</td>
</tr>
<tr class="even">
<td>2010</td>
<td>A</td>
<td>5</td>
</tr>
<tr class="odd">
<td>201o</td>
<td>B</td>
<td>6</td>
</tr>
<tr class="even">
<td>2010</td>
<td>C</td>
<td>12</td>
</tr>
<tr class="odd">
<td>2010</td>
<td>A</td>
<td>7</td>
</tr>
<tr class="even">
<td>201o</td>
<td>B</td>
<td>8</td>
</tr>
<tr class="odd">
<td>2010</td>
<td>C</td>
<td>13</td>
</tr>
</tbody>
</table>
<p>The long format makes it easier to generically subset the data to be
used in functions. For this reason, EDAB would prefer to receive data in
the long format. More specifically, we are looking for the following
columns:</p>
<p>Table 3: Required columns for the SOE</p>
<table class="table">
<thead><tr class="header">
<th>Year</th>
<th>Var</th>
<th>Value</th>
<th>EPU</th>
<th>Units</th>
</tr></thead>
<tbody><tr class="odd">
<td>2010</td>
<td>SST</td>
<td>21</td>
<td>GOM</td>
<td>C</td>
</tr></tbody>
</table>
<p>Time: Time stamp of the variable. Typically this is the year but
could be day of the week or month, etc. Var: Name of variable. Use a
short description such as “Piscivore Landings”. Value: The numerical
value for the data point. Units: Units for the variable. See
standardized list below. EPU: Ecological production unit or shelf-wide.
See standardized list below.</p>
</div>
<div class="section level3">
<h3 id="standarized-lists">Standarized lists<a class="anchor" aria-label="anchor" href="#standarized-lists"></a>
</h3>
<p>Here is the list of standardized unit notation. Note that this list
may not be comprehensive. However this should give you an idea of how to
label units. If the units of your variable are not list please contact
Sean Lucey for guidance. Having standard notation for units helps in
labeling the y-axis.</p>
<p>Table 4: Examples of unit standardization</p>
<table class="table">
<thead><tr class="header">
<th>Abbrev</th>
<th>Units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>unitless</td>
<td>No Units</td>
</tr>
<tr class="even">
<td>anomaly</td>
<td>standardized anomaly</td>
</tr>
<tr class="odd">
<td>degrees latitude</td>
<td>position in latitude</td>
</tr>
<tr class="even">
<td>kmˆ2</td>
<td>square kilometers degrees</td>
</tr>
<tr class="odd">
<td>C</td>
<td>temperature in Celsius</td>
</tr>
<tr class="even">
<td>n</td>
<td>number</td>
</tr>
<tr class="odd">
<td>US dollars</td>
<td>currency</td>
</tr>
<tr class="even">
<td>n per 100m3</td>
<td>number per 100 cubic meters</td>
</tr>
<tr class="odd">
<td>kg towˆ-1</td>
<td>kilograms per tow</td>
</tr>
</tbody>
</table>
<p>Please use the abbreviations below to indicate to which ecological
production unit (EPU) your indicator belongs. This will aid in
separating the data between the Mid-Atlantic and New England.</p>
<p>Table 5: Standard notation for EPUs</p>
<table class="table">
<thead><tr class="header">
<th>Abbrev</th>
<th>EPU</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>GB</td>
<td>Georges Bank</td>
</tr>
<tr class="even">
<td>GOM</td>
<td>Gulf of Maine</td>
</tr>
<tr class="odd">
<td>MAB</td>
<td>Mid-Atlantic Bight</td>
</tr>
<tr class="even">
<td>SS</td>
<td>Scotian Shelf</td>
</tr>
<tr class="odd">
<td>All</td>
<td>Shelf-wide</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="convert-wide-to-long">Convert Wide to Long<a class="anchor" aria-label="anchor" href="#convert-wide-to-long"></a>
</h3>
<p>If your data is already in wide format, here is a simply function for
converting your data to long. There are examples below for using
<code>data.table</code> as well as a <code>tidyverse</code> solution.
Run this code in R and follow the example. Note the are <code>R</code>
examples.</p>
<div class="section level4">
<h4 id="tidyverse">tidyverse<a class="anchor" aria-label="anchor" href="#tidyverse"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#This function requires the data.table package library(tidyverse) </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">wide.format</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1</span> , <span class="fl">2</span> , <span class="fl">3</span> <span class="op">)</span>,  VarA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1</span> , <span class="fl">2</span> , <span class="fl">3</span> <span class="op">)</span>, </span>
<span>                          VarB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">4</span> , <span class="fl">5</span> , <span class="fl">6</span> <span class="op">)</span>, VarC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">7</span> , <span class="fl">8</span> , <span class="fl">9</span> <span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">long.formart</span> <span class="op">&lt;-</span> <span class="va">wide.format</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">VarA</span>, <span class="va">VarB</span>, <span class="va">VarC</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Var"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># convert wide to long</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kg tows^-1"</span><span class="op">)</span>, <span class="co"># add Uints</span></span>
<span>                EPU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOM"</span><span class="op">)</span><span class="op">)</span> <span class="co"># add epu</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-table">data.table<a class="anchor" aria-label="anchor" href="#data-table"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#This function requires the data.table package library(data.table) </span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#Function to convert from wide to long </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>w2l <span class="ot">&lt;-</span> <span class="cf">function</span>(x, by, <span class="at">by.name =</span> Time , <span class="at">value.name =</span> Value ){ </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  x.new <span class="ot">&lt;-</span> <span class="fu">copy</span>(x)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  var.names <span class="ot">&lt;-</span> <span class="fu">names</span>(x)[<span class="fu">which</span>(<span class="fu">names</span>(x) <span class="sc">!=</span> by)] </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="fu">setnames</span>(x.new, by, by ) </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var.names)){ </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="fu">setnames</span>(x.new, var.names[i], V1 ) </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    single.var <span class="ot">&lt;-</span> x.new[, <span class="fu">list</span>(by, V1)] </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    single.var[, Var <span class="sc">:=</span> var.names[i]] </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(out, single.var)) </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="fu">setnames</span>(x.new, V1 , var.names[i]) </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="fu">setnames</span>(x.new, by , by) </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="fu">setnames</span>(out, <span class="fu">c</span>( by , V1 ), <span class="fu">c</span>(by.name, value.name)) </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  }<span class="co">#Simple example from above </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#Wide table </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>wide.format <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">Year =</span> <span class="fu">c</span>( <span class="dv">1</span> , <span class="dv">2</span> , <span class="dv">3</span> ),  <span class="at">VarA =</span> <span class="fu">c</span>( <span class="dv">1</span> , <span class="dv">2</span> , <span class="dv">3</span> ), </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>                          <span class="at">VarB =</span> <span class="fu">c</span>( <span class="dv">4</span> , <span class="dv">5</span> , <span class="dv">6</span> ), <span class="at">VarC =</span> <span class="fu">c</span>( <span class="dv">7</span> , <span class="dv">8</span> , <span class="dv">9</span> )) </span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">print</span>(wide.format) </span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="do">## Year VarA VarB VarC ## 1: 1 1 4 7 ## 2: 2 2 5 8 ## 3: 3 3 6 9 </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>long.format <span class="ot">&lt;-</span> <span class="fu">w2l</span>(wide.format, <span class="at">by =</span> Year ) </span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="fu">print</span>(long.format) </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="do">## Time Value Var ## 1: 1 1 VarA ## 2: 2 2 VarA ## 3: 3 3 VarA ## 4: 1 4 VarB ## 5: 2 5 VarB ## 6: 3 6 VarB ## 7: 1 7 VarC ## 8: 2 8 VarC ## 9: 3 9 VarC #Notice that the w2l function named the columns to the ones noted above #but did not add units, region, or source 3 </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#Add units and region manually </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">Units =</span> <span class="fu">c</span>(<span class="fu">rep</span>( kg tows<span class="sc">^-</span><span class="dv">1</span> , <span class="dv">6</span>), </span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                              <span class="fu">rep</span>( n per <span class="dv">100</span>m3 , <span class="dv">3</span>))) </span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">Region =</span> <span class="fu">rep</span>( GB , <span class="dv">9</span>)) </span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>source <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">Source =</span> <span class="fu">c</span>(<span class="fu">rep</span>( NEFSC survey <span class="fu">data</span> (Survdat) , <span class="dv">6</span>), </span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>                                <span class="fu">rep</span>( NEFSC ECOMON data , <span class="dv">3</span>))) </span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>long.format <span class="ot">&lt;-</span> <span class="fu">cbind</span>(long.format, units) </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>long.format <span class="ot">&lt;-</span> <span class="fu">cbind</span>(long.format, region) </span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>long.format <span class="ot">&lt;-</span> <span class="fu">cbind</span>(long.format, source) <span class="fu">print</span>(long.format) </span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="do">## Time Value Var Units Region Source ## 1: 1 1 VarA kg tows^-1 GB NEFSC survey data (Survdat) ## 2: 2 2 VarA kg tows^-1 GB NEFSC survey data (Survdat) ## 3: 3 3 VarA kg tows^-1 GB NEFSC survey data (Survdat) ## 4: 1 4 VarB kg tows^-1 GB NEFSC survey data (Survdat) ## 5: 2 5 VarB kg tows^-1 GB NEFSC survey data (Survdat) ## 6: 3 6 VarB kg tows^-1 GB NEFSC survey data (Survdat) ## 7: 1 7 VarC n per 100m3 GB NEFSC ECOMON data ## 8: 2 8 VarC n per 100m3 GB NEFSC ECOMON data ## 9: 3 9 VarC n per 100m3 GB NEFSC ECOMON data </span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Brandon Beltz, Kimberly Bastille, Sean Hardison.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
